{"ast":null,"code":"import _regeneratorRuntime from \"/Users/mac/udacity/cloud-developer /course-04/project/sls-todo-app/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"/Users/mac/udacity/cloud-developer /course-04/project/sls-todo-app/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { apiEndpoint } from '../config';\nimport Axios from 'axios';\nexport function getTodos(_x) {\n  return _getTodos.apply(this, arguments);\n}\n\nfunction _getTodos() {\n  _getTodos = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(idToken) {\n    var response;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log('Fetching todos');\n            _context.next = 3;\n            return Axios.get(\"\".concat(apiEndpoint, \"/todos\"), {\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': \"Bearer \".concat(idToken)\n              }\n            });\n\n          case 3:\n            response = _context.sent;\n            console.log('Todos:', response.data);\n            return _context.abrupt(\"return\", response.data.items);\n\n          case 6:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getTodos.apply(this, arguments);\n}\n\nexport function createTodo(_x2, _x3) {\n  return _createTodo.apply(this, arguments);\n}\n\nfunction _createTodo() {\n  _createTodo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(idToken, newTodo) {\n    var response;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.next = 2;\n            return Axios.post(\"\".concat(apiEndpoint, \"/todos\"), JSON.stringify(newTodo), {\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': \"Bearer \".concat(idToken)\n              }\n            });\n\n          case 2:\n            response = _context2.sent;\n            return _context2.abrupt(\"return\", response.data.item);\n\n          case 4:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return _createTodo.apply(this, arguments);\n}\n\nexport function patchTodo(_x4, _x5, _x6) {\n  return _patchTodo.apply(this, arguments);\n}\n\nfunction _patchTodo() {\n  _patchTodo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(idToken, todoId, updatedTodo) {\n    return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            _context3.next = 2;\n            return Axios.patch(\"\".concat(apiEndpoint, \"/todos/\").concat(todoId), JSON.stringify(updatedTodo), {\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': \"Bearer \".concat(idToken)\n              }\n            });\n\n          case 2:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _patchTodo.apply(this, arguments);\n}\n\nexport function deleteTodo(_x7, _x8) {\n  return _deleteTodo.apply(this, arguments);\n}\n\nfunction _deleteTodo() {\n  _deleteTodo = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4(idToken, todoId) {\n    return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return Axios.delete(\"\".concat(apiEndpoint, \"/todos/\").concat(todoId), {\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': \"Bearer \".concat(idToken)\n              }\n            });\n\n          case 2:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n  return _deleteTodo.apply(this, arguments);\n}\n\nexport function getUploadUrl(_x9, _x10) {\n  return _getUploadUrl.apply(this, arguments);\n}\n\nfunction _getUploadUrl() {\n  _getUploadUrl = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5(idToken, todoId) {\n    var response;\n    return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n      while (1) {\n        switch (_context5.prev = _context5.next) {\n          case 0:\n            _context5.prev = 0;\n            _context5.next = 3;\n            return Axios.post(\"\".concat(apiEndpoint, \"/todos/\").concat(todoId, \"/attachment\"), '', {\n              headers: {\n                'Content-Type': 'application/json',\n                'Authorization': \"Bearer \".concat(idToken)\n              }\n            });\n\n          case 3:\n            response = _context5.sent;\n            return _context5.abrupt(\"return\", response.data.uploadUrl);\n\n          case 7:\n            _context5.prev = 7;\n            _context5.t0 = _context5[\"catch\"](0);\n            console.error('get upload url', _context5.t0);\n\n          case 10:\n            return _context5.abrupt(\"return\", '');\n\n          case 11:\n          case \"end\":\n            return _context5.stop();\n        }\n      }\n    }, _callee5, null, [[0, 7]]);\n  }));\n  return _getUploadUrl.apply(this, arguments);\n}\n\nexport function uploadFile(_x11, _x12) {\n  return _uploadFile.apply(this, arguments);\n}\n\nfunction _uploadFile() {\n  _uploadFile = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(uploadUrl, file) {\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) {\n        switch (_context6.prev = _context6.next) {\n          case 0:\n            _context6.prev = 0;\n            _context6.next = 3;\n            return Axios.put(uploadUrl, file);\n\n          case 3:\n            _context6.next = 8;\n            break;\n\n          case 5:\n            _context6.prev = 5;\n            _context6.t0 = _context6[\"catch\"](0);\n            console.error(\" Upload file\", _context6.t0);\n\n          case 8:\n          case \"end\":\n            return _context6.stop();\n        }\n      }\n    }, _callee6, null, [[0, 5]]);\n  }));\n  return _uploadFile.apply(this, arguments);\n}","map":{"version":3,"names":["apiEndpoint","Axios","getTodos","idToken","console","log","get","headers","response","data","items","createTodo","newTodo","post","JSON","stringify","item","patchTodo","todoId","updatedTodo","patch","deleteTodo","delete","getUploadUrl","uploadUrl","error","uploadFile","file","put"],"sources":["/Users/mac/udacity/cloud-developer /course-04/project/sls-todo-app/client/src/api/todos-api.ts"],"sourcesContent":["import { apiEndpoint } from '../config'\nimport { Todo } from '../types/Todo';\nimport { CreateTodoRequest } from '../types/CreateTodoRequest';\nimport Axios from 'axios'\nimport { UpdateTodoRequest } from '../types/UpdateTodoRequest';\n\nexport async function getTodos(idToken: string): Promise<Todo[]> {\n  console.log('Fetching todos')\n\n  const response = await Axios.get(`${apiEndpoint}/todos`, {\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${idToken}`\n    },\n  })\n  console.log('Todos:', response.data)\n  return response.data.items\n}\n\nexport async function createTodo(\n  idToken: string,\n  newTodo: CreateTodoRequest\n): Promise<Todo> {\n  const response = await Axios.post(`${apiEndpoint}/todos`,  JSON.stringify(newTodo), {\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${idToken}`\n    }\n  })\n  return response.data.item\n}\n\nexport async function patchTodo(\n  idToken: string,\n  todoId: string,\n  updatedTodo: UpdateTodoRequest\n): Promise<void> {\n  await Axios.patch(`${apiEndpoint}/todos/${todoId}`, JSON.stringify(updatedTodo), {\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${idToken}`\n    }\n  })\n}\n\nexport async function deleteTodo(\n  idToken: string,\n  todoId: string\n): Promise<void> {\n  await Axios.delete(`${apiEndpoint}/todos/${todoId}`, {\n    headers: {\n      'Content-Type': 'application/json',\n      'Authorization': `Bearer ${idToken}`\n    }\n  })\n}\n\nexport async function getUploadUrl(\n  idToken: string,\n  todoId: string\n): Promise<string> {\n  try {\n    const response = await Axios.post(`${apiEndpoint}/todos/${todoId}/attachment`, '', {\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${idToken}`\n        }\n      })\n    return response.data.uploadUrl\n  }\ncatch(err){\nconsole.error('get upload url', err)\n}\n  return ''\n}\n\nexport async function uploadFile(uploadUrl: string, file: Buffer): Promise<void> {\n  try {\n  await Axios.put(uploadUrl, file)\n  } catch(err){\n      console.error(\" Upload file\", err)\n}\n    \n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}